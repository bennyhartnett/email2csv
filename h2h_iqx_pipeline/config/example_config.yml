project:
  name: "H2H IQX Pipeline"
  environment: "dev"

paths:
  # Root folder that contains month subfolders
  input_root: "/path/to/VetTalents"
  # Where to write combined Excel, CSV, and QA reports
  output_root: "/path/to/VetTalents/output"
  # Where logs should go (relative to project root)
  log_dir: "logs"

run:
  # The month to process; CLI can override this
  current_month: "2025-12"
  previous_month: "2025-11"
  # Optional label for output files (defaults to latest Create Date in inputs)
  output_date: "2025-12-04"

combo_files:
  excel_pattern: "Combo H2H IBEW 4 8 9 Iron {date}.xlsx"
  csv_pattern: "Bulk Import H2H Combo IBEW 4 8 9 Iron {date}.csv"

date_handling:
  # Strategy for determining last import cutoff:
  # "from_combo_file" or "from_config"
  last_import_strategy: "from_config"
  # Only used if strategy is "from_config"
  last_import_date_by_source:
    "IBEW D4": "2025-11-20"
    "IBEW D8": "2025-11-20"
    "IBEW D9": "2025-11-20"
    "Ironworkers": "2025-11-20"
  timezone: "US/Eastern"
  # Output date format for date_available/end_date
  output_format: "%m/%d/%Y"
  # Include the cutoff date itself when filtering (default auto based on previous combo)
  include_cutoff_date: false
  # Drop rows already present in the previous combo (when available)
  exclude_previously_imported: true

sources:
  - name: "IBEW D4"
    code: "IBEW_4"
    output_label: "IBEW 4"
    # Glob or regex used to find files for this source in the month folder
    file_pattern: "Career Seekers Interested in IBEW D4 *.xlsx"
  - name: "IBEW D8"
    code: "IBEW_8"
    output_label: "IBEW 8"
    file_pattern: "Career Seekers Interested in IBEW D8 *.xlsx"
  - name: "IBEW D9"
    code: "IBEW_9"
    output_label: "IBEW 9"
    file_pattern: "Career Seekers Interested in IBEW D9 *.xlsx"
  - name: "Ironworkers"
    code: "IRON"
    output_label: "Ironworkers"
    file_pattern: "Career Seekers Interested in Ironworkers *.xlsx"

mappings:
  professions: "config/mappings/professions.yml"
  service_branches: "config/mappings/service_branches.yml"
  source_priority: "config/mappings/source_priority.yml"

iqx_import:
  # Column order required by IQX bulk import CSV
  column_order:
    - "Summary - Bulk Import Failure Notes"
    - "external_identifier"
    - "external_source"
    - "internal_comment"
    - "date_available"
    - "end_date"
    - "location_radius"
    - "last_name"
    - "first_name"
    - "phone_number"
    - "email"
    - "location_zip"
    - "profession"
    - "industry"
    - "talent_price_category"
    - "clearance_level"
    - "clearance_agency"
    - "clearance_status"
    - "clearance_investigation"

defaults:
  location_radius: 100
  industry: "23 Construction"
  talent_price_category: "A"
  # Strategy for external_identifier: blank, record_id, email_or_phone
  external_identifier_strategy: "blank"
  # Offset in days from output_date (or latest Create Date) for 'date_available'
  date_available_offset_days: 6
  # Years after 'date_available' for 'end_date'
  end_date_years_from_available: 1
